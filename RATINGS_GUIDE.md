# מדריך: איך הדירוגים נשמרים

## המערכת כבר מוכנה לשמירת דירוגים! ✅

הדירוגים נשמרים אוטומטית במסד הנתונים Supabase כאשר משתמש מדרג כלי.

### איך זה עובד:

1. **משתמש מדרג כלי** - לחץ על כפתור "Rate" בכל כרטיס כלי או בעמוד הפרטים
2. **הדירוג נשלח לשרת** - דרך `/api/ratings` (POST request)
3. **הדירוג נשמר ב-Supabase** - בטבלת `ratings` במסד הנתונים
4. **הסטטיסטיקות מתעדכנות** - דרך ה-view `tool_stats` שמחשב:
   - מספר הביקורות הכולל
   - דירוג ממוצע
   - אחוז "Good for creators"
   - אחוז "Worth the money"

### הגנות נגד ספאם:

- **Rate limiting**: משתמש יכול לדרג כלי אחד פעם ב-24 שעות (תבסס על fingerprint)
- **Fingerprint hash**: כל דירוג מקושר ל-fingerprint hash ייחודי של המשתמש
- **IP hash**: אופציונלי, הגנה נוספת

### איך לבדוק שהדירוגים נשמרים:

1. **דרג כלי** - לחץ על "Rate" בכל כלי והגש דירוג
2. **רענן את הדף** - הדירוגים והסטטיסטיקות אמורים להתעדכן
3. **בדוק ב-Supabase** - אפשר לבדוק ישירות בטבלת `ratings` ב-Supabase Dashboard

### מבנה הטבלה:

```sql
ratings (
  id UUID,
  tool_id UUID,
  stars INTEGER (1-5),
  good_for_creators BOOLEAN,
  worth_money BOOLEAN,
  comment VARCHAR(200),
  anon_fingerprint_hash VARCHAR(64),
  ip_hash VARCHAR(64),
  created_at TIMESTAMP
)
```

### הערות:

- הדירוגים נשמרים **אוטומטית** - אין צורך לעשות כלום נוסף
- הסטטיסטיקות מתעדכנות **מיידית** לאחר כל דירוג
- כל דירוג נשמר **לצמיתות** במסד הנתונים
